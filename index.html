<!DOCTYPE html>
<html lang="en">

<script src="jquery.js"></script>
<script src="jquery-ui.min.js"></script>
<script src="jquery-ui.js"></script>

<div id="master-container">
    <div id="cursor"></div>
    <div id="positionback"></div>
    <div id="laserbeam"></div>
    <div id="off_button" class="transition"></div>
    <div class="target transition" id="target1"></div>
</div>

<script>

    var isOn = false;
    var visibility = "hidden";
    var global_mousepos = 0;

    document.getElementById("master-container").onmousemove = function(event){
        event = window.event;

        var mouseX = event.pageX;
        var mouseY = event.pageY;

        if (isOn) global_mousepos = mouseY;

        console.log("MouseX: " + mouseX + "% | MouseY: " + mouseY +"%");
        
        $("#cursor").css({
            "top": mouseY - $("#cursor").height()/2,
            "left": mouseX - $("#cursor").width()/2,
            "visibility": "visible"
        });

        $("#positionback").css({
            "visibility": "visible",
            "top": mouseY - $("#positionback").height()/2,
            "left": mouseX - 6
        });

        $("#laserbeam").css({
            "visibility": visibility,
            "top": mouseY - $("#positionback").height()/2,
            "left": mouseX + 8
        });
    }

    document.getElementById("off_button").onclick = function(){
        isOn = !isOn;

        console.log(isOn);

        var isOn_doc = document.getElementById("off_button");

        if (isOn){
            visibility = "visible";
        } else {
            visibility = "hidden";
            $("#laserbeam").css({
                "visibility": "hidden"
            });
        } 

        (isOn) ? isOn_doc.style.backgroundColor = "#fff" : isOn_doc.style.backgroundColor = "#820202";
    }

    function flipOut(id){

        $(id).css({
            "transform-style": "preserve-3d",
          	"transform": "rotateY(-90deg)"
        })

    }

    var already_hit = [];

    setInterval(function(){

        var maximum = 0;

        for (var i = 1; i < 2; i++){

            for (var b = 0; b < already_hit.length; b++){

                console.log(already_hit[b]);
                if (already_hit[b] == target_top){
                    console.log("Target already hit");
                    return;
                }

            }

            var target_top = $("#target"+i).position().top;
            var target = document.getElementById("target" + i);
            var target_bottom = target_top + $("#target"+i).height();

            console.log("Top:" + target_top + " bottom:"+target_bottom + " mouse:"+global_mousepos);

           if (between(global_mousepos, target_top, target_bottom)){
                console.log("you hit the target!");
                flipOut("#target"+i);
                already_hit.push(target_top);
                return;
            }

        }

    });

function between(x, min, max) {
  return x >= min && x <= max;
}

</script>

<style>
    html {
        cursor: none;
    }
    
    #cursor {
        position: fixed; 
        height: 15%; 
        width: 10%; 
        background-image: url(image1.png); 
        cursor: hidden; 
        background-size: cover; 
        background-size: contain;
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
        background-repeat: no-repeat;
        background-position: 50% 92%;
        left: 50%;
        top: 50%;
        transform: rotate(90deg);
        visibility: hidden;
    }

    #positionback {
        position: fixed;
        height: 1.5%;
        width: .75%;
        border-bottom: 50%;    
        left: 95%;
        background-color: #d11f1f;
        visibility: hidden;
        border-radius: 50%;
    }

    #laserbeam {
        position: fixed;
        height: 1.5%;
        width: 200%;
        border-bottom: 50%;    
        left: 95%;
        background-color: #d11f1f;
        visibility: hidden;
        border-radius: 50%;
    }

    #off_button {
        position: fixed;
        height: 15%; 
        width: 20%;
        left: 40%;
        top: 80%;
        background-color: #820202;
        border-radius: 3%;
        padding-top: 1%;
        padding-left: 2%;
        padding-right: 2%;
    }

    #target1 {
        left: 88%;
        top: 10%;
    }

    #master-container {
        position: fixed;
        height: 100%;
        width: 100%;
        top: 0%;
        left: 0%;
        background-image: url(Untitled-3.jpg);
    }
    
    .transition {
		-webkit-transition: all .2s ease;
		-moz-transition: all .2s ease;
		-o-transition: all .2s ease;
		-ms-transition: all .2 ease;
        transition: all .2s ease;
    }

    .target {
        position: relative; 
        height: 20%; 
        width: 12%;
        background-image: url(target_PNG65.png);
        background-size: cover; 
        background-size: contain;
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
        background-repeat: no-repeat;
        background-position: -1%;
        background-size: 90%;
        transform-style: preserve-3d;
        transforM: rotateY(-70deg);
        z-index: -1;
    }
</style>

</html>